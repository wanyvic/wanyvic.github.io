<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/corgi_32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/corgi_16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="l0k1Y36UcsrN3dPCcAYthwLa5h11Gn8uU_6590PS-LM">
  <meta name="baidu-site-verification" content="code-XQEfkj505K">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"wanyvic.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.10.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

  <meta name="description" content="观前提示 以下时间均为北京时间  参与者    角色 地址 备注     攻击者 Exploiter 0x48c94305bddfd80c6f4076963866d968cac27d79 BXH攻击者外部账户   攻击合约 Attacker 0x887716168FC8c1A2933F97ea3858a94c9E229201 BXH攻击者创建的攻击合约（通过此合约攻击BXH策略）创建于 2021">
<meta property="og:type" content="article">
<meta property="og:title" content="BXH被盗分析">
<meta property="og:url" content="https://wanyvic.github.io/posts/4b1fd5af/index.html">
<meta property="og:site_name" content="Wanyvicの博客">
<meta property="og:description" content="观前提示 以下时间均为北京时间  参与者    角色 地址 备注     攻击者 Exploiter 0x48c94305bddfd80c6f4076963866d968cac27d79 BXH攻击者外部账户   攻击合约 Attacker 0x887716168FC8c1A2933F97ea3858a94c9E229201 BXH攻击者创建的攻击合约（通过此合约攻击BXH策略）创建于 2021">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-11-03T03:09:50.000Z">
<meta property="article:modified_time" content="2021-11-03T03:09:50.000Z">
<meta property="article:author" content="wanyvic">
<meta property="article:tag" content="区块链">
<meta property="article:tag" content="智能合约">
<meta property="article:tag" content="BXH">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://wanyvic.github.io/posts/4b1fd5af/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wanyvic.github.io/posts/4b1fd5af/","path":"posts/4b1fd5af/","title":"BXH被盗分析"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>BXH被盗分析 | Wanyvicの博客</title>
  




<link rel="dns-prefetch" href="https://waline-kappa-three.vercel.app"><link rel="stylesheet" type="text/css" href="/css/injector/main.css" /><link rel="preload" as="style" href="/css/injector/light.css" /><link rel="preload" as="style" href="/css/injector/dark.css" />
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Wanyvicの博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">区块链攻城狮</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">49</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">4</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">42</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%82%E5%89%8D%E6%8F%90%E7%A4%BA"><span class="nav-number">1.</span> <span class="nav-text">观前提示</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E4%B8%8E%E8%80%85"><span class="nav-number">2.</span> <span class="nav-text">参与者</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E6%97%B6%E5%BA%8F%E5%9B%BE"><span class="nav-number">3.</span> <span class="nav-text">攻击时序图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%8E%E6%94%BB%E5%87%BB%E8%80%85%E8%A7%92%E5%BA%A6%E5%8E%BB%E5%88%86%E6%9E%90"><span class="nav-number">4.</span> <span class="nav-text">从攻击者角度去分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ACL%E5%86%85%E9%83%A8%E8%A7%92%E8%89%B2%E5%AF%B9%E5%BA%94%E7%9A%84bytes32%E7%9A%84%E5%80%BC"><span class="nav-number">5.</span> <span class="nav-text">ACL内部角色对应的bytes32的值</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E8%80%85%E5%B0%9D%E8%AF%95%E7%9A%848%E6%AC%A1%E6%94%BB%E5%87%BB"><span class="nav-number">6.</span> <span class="nav-text">攻击者尝试的8次攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.1.</span> <span class="nav-text">第一次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.2.</span> <span class="nav-text">第二次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.3.</span> <span class="nav-text">第三次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.4.</span> <span class="nav-text">第四次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.5.</span> <span class="nav-text">第五次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.6.</span> <span class="nav-text">第六次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.7.</span> <span class="nav-text">第七次升级逻辑代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E6%AC%A1%E5%8D%87%E7%BA%A7%E9%80%BB%E8%BE%91%E4%BB%A3%E7%A0%81"><span class="nav-number">6.8.</span> <span class="nav-text">第八次升级逻辑代码</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wanyvic"
      src="/images/ProfilePhoto.PNG">
  <p class="site-author-name" itemprop="name">wanyvic</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">42</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/wanyvic" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wanyvic" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:q873040807@gmail.com" title="E-Mail → mailto:q873040807@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

  <a href="https://github.com/wanyvic" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wanyvic.github.io/posts/4b1fd5af/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ProfilePhoto.PNG">
      <meta itemprop="name" content="wanyvic">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wanyvicの博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BXH被盗分析
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-11-03 11:09:50" itemprop="dateCreated datePublished" datetime="2021-11-03T11:09:50+08:00">2021-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/" itemprop="url" rel="index"><span itemprop="name">区块链</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/posts/4b1fd5af/#waline-comments" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" id="/posts/4b1fd5af/" data-xid="/posts/4b1fd5af/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="观前提示"><a class="header-anchor" href="#观前提示"> </a>观前提示</h1>
<p>以下时间均为北京时间</p>
<h1 id="参与者"><a class="header-anchor" href="#参与者"> </a>参与者</h1>
<table>
<thead>
<tr>
<th>角色</th>
<th>地址</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>攻击者 Exploiter</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">0x48c94305bddfd80c6f4076963866d968cac27d79</a></td>
<td>BXH攻击者外部账户</td>
</tr>
<tr>
<td>攻击合约 Attacker</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">0x887716168FC8c1A2933F97ea3858a94c9E229201</a></td>
<td>BXH攻击者创建的攻击合约（通过此合约攻击BXH策略）创建于 <a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xf0a833371d843130601dca50553a203e2a07940ec531592cbd3c48003ace34bd">2021-10-27 21:47:34</a></td>
</tr>
<tr>
<td>攻击者收款合约</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c">0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</a></td>
<td>创建于 <a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x6119e86085440083b8e8b6f5435cbc6480df7fde541c8028d013dce7245720a5">2021-10-30 11:15:45</a></td>
</tr>
<tr>
<td>BXH策略地址</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x6AcECA12de5a15f11ca51b654433259533B0B802">0x6AcECA12de5a15f11ca51b654433259533B0B802</a></td>
<td>BXH策略资金地址</td>
</tr>
<tr>
<td>BXH管理员</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x56146b129017940d06d8e235c02285a3d05d6b7c">0x56146b129017940d06d8e235c02285a3d05d6b7c</a></td>
<td>总管理员</td>
</tr>
<tr>
<td>BXH访问权限控制合约</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x83dae57c46985c3a2346e8a3c6991ca908f8b06b">0x83dae57c46985c3a2346e8a3c6991ca908f8b06b</a></td>
<td>用于控制各个合约访问权限</td>
</tr>
</tbody>
</table>
<h1 id="攻击时序图"><a class="header-anchor" href="#攻击时序图"> </a>攻击时序图</h1>
<pre class="mermaid">
sequenceDiagram
participant Exploiter as 攻击者 Exploiter
participant Attacker as 攻击合约 Attacker
participant AttackContract as 攻击者收款合约 AttackContract
participant ACL as BXH访问权限控制合约 ACL
participant BXH as BXH策略合约
participant master as BXH管理员
rect rgba(0, 0, 255, .1)
Exploiter-&gt;&gt;Attacker: 2021-10-27 21:47:34 创建攻击合约
master-&gt;&gt;+ACL: 2021-10-29 16:19:00 给攻击合约提权
ACL--&gt;&gt;-Attacker: 攻击合约获得权限
%% Note over Exploiter,master: 省略:期间尝试七次攻击,均失败
end
Exploiter-&gt;&gt;AttackContract: 2021-10-30 11:15:45 创建攻击者收款合约
Exploiter-&gt;&gt;+Attacker: 2021-10-30 11:27:47 给攻击者收款合约提权
Attacker--&gt;&gt;+ACL: 访问权限控制合约0xf047601d函数，给攻击者收款合约尝试提权
ACL--&gt;&gt;-AttackContract: ACL内部调用收款合约的0x1f1fcd51。最后给攻击者收款合约添加INTERFACE_ROLE角色
deactivate Attacker
Exploiter-&gt;&gt;+Attacker:2021-10-30 11:32:53 第八次发起攻击
Attacker--&gt;&gt;+ACL: 调用ACL的0x8b6b802函数，此函数反编译失败。但猜测内部将资产从策略合约转移给攻击者
ACL--&gt;&gt;+BXH:请求资产转移
BXH--&gt;&gt;-AttackContract:资产转移至攻击者收款合约
deactivate ACL
AttackContract--&gt;&gt;Exploiter:ETH转移至攻击者
deactivate Attacker
</pre>
<p><strong>注:</strong> 攻击者在最后一次成功攻击前，有7次尝试更改逻辑代码的失败攻击。</p>
<h1 id="从攻击者角度去分析"><a class="header-anchor" href="#从攻击者角度去分析"> </a>从攻击者角度去分析</h1>
<ol>
<li>
<p><strong>2021-10-29 16:19:00</strong> 未知原因拥有BXH最高权限的管理员给Attacker开启<code>GOVERNANCE_ROLE</code>权限。</p>
<ul>
<li>此角色可能是添加删除策略的权限。</li>
<li>txid: <a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x992c4b9e5cb5c42fbe35403e1e85034fa42beb5bebb3bfa930d1e6dca37742cf">0x992c4b9e5cb5c42fbe35403e1e85034fa42beb5bebb3bfa930d1e6dca37742cf</a></li>
</ul>
</li>
<li>
<p><strong>2021-10-30 11:27:47</strong> Exploiter给AttackContract添加<code>INTERFACE_ROLE</code>权限。</p>
<ul>
<li>猜测0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c伪装成策略合约并获得权限。</li>
<li>txid: <a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x94c3dac0df93d13205f78509dc79363c3c79e4d50f4a5a2a3614ba11e457fa1d">0x94c3dac0df93d13205f78509dc79363c3c79e4d50f4a5a2a3614ba11e457fa1d</a></li>
</ul>
</li>
<li>
<p><strong>2021-10-30 11:32:53</strong> Exploiter通过<code>GOVERNANCE_ROLE</code>权限对ACL合约发起攻击成功获取资产。</p>
<ul>
<li>此处可能是调用了类似于策略调仓的逻辑，将BXH策略内的资产转移给AttackContract。</li>
<li>txid: <a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x6466cad9ad300054f0d560db5619a299f67883ad51b6aeafad3061d09674ac84">0x6466cad9ad300054f0d560db5619a299f67883ad51b6aeafad3061d09674ac84</a></li>
</ul>
</li>
</ol>
<h1 id="ACL内部角色对应的bytes32的值"><a class="header-anchor" href="#ACL内部角色对应的bytes32的值"> </a>ACL内部角色对应的bytes32的值</h1>
<table>
<thead>
<tr>
<th>ACL内角色</th>
<th>bytes32</th>
</tr>
</thead>
<tbody>
<tr>
<td>keccak256(‘INTERFACE_ROLE’)</td>
<td>0x886f5b5d23a7f8b3645010a8eb98414557d4607145067846682ff187e4950fe3</td>
</tr>
<tr>
<td>keccak256(‘WITHDRAW_ROLE’)</td>
<td>0x5d8e12c39142ff96d79d04d15d1ba1269e4fe57bb9d26f43523628b34ba108ec</td>
</tr>
<tr>
<td>keccak256(‘GOVERNANCE_ROLE’)</td>
<td>0x71840dc4906352362b0cdaf79870196c8e42acafade72d5d5a6d59291253ceb1</td>
</tr>
</tbody>
</table>
<span id="more"></span>
<h1 id="攻击者尝试的8次攻击"><a class="header-anchor" href="#攻击者尝试的8次攻击"> </a>攻击者尝试的8次攻击</h1>
<h2 id="第一次升级逻辑代码"><a class="header-anchor" href="#第一次升级逻辑代码"> </a>第一次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-27 21:47:34</td>
<td>攻击者创建攻击合约</td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x6119e86085440083b8e8b6f5435cbc6480df7fde541c8028d013dce7245720a5">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-29 15:58:53</td>
<td>给攻击合约第一次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x2d4d4b79249e6f03cf0e8d672bfc32bdb07981df">0x2d4d4b79249e6f03cf0e8d672bfc32bdb07981df</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x7e8c28a0af1e70a39b493f32da191d56836f6ce46b7f6fe83af1d066971fa459">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-29 22:26:36</td>
<td>尝试取款失败，参数填的是ETH合约地址</td>
<td>withdraw(<code>2170ed0880ac9a755fd29b2688956bd959f933f8</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x831f1e2915305abd32eaa7399c17623f3f34fac956d71bedba41cb3469d95241">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第二次升级逻辑代码"><a class="header-anchor" href="#第二次升级逻辑代码"> </a>第二次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 03:45:16</td>
<td>给攻击合约第二次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x9e47d35f352d322670e5c6def2174d1ae739b3ca">0x9e47d35f352d322670e5c6def2174d1ae739b3ca</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x7467e536acae21b407bc2e0ca4e4522208dce94830eadd5a1a349517dc3632ae">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 03:51:19</td>
<td>尝试取款失败</td>
<td>withdraw()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x4c4c55bca50687487b12c1b2b2e5d9ec8900514d09639cd1a35174f4cb154404">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第三次升级逻辑代码"><a class="header-anchor" href="#第三次升级逻辑代码"> </a>第三次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:01:10</td>
<td>给攻击合约第三次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x977171a577cf954663457af5a2bdc7b1a9951e3b">0x977171a577cf954663457af5a2bdc7b1a9951e3b</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x332ccad03edf5dd679101595e7b6f1cd3afba6f9f225ed57fda832081448aca7e">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:04:35</td>
<td>尝试取款失败</td>
<td>withdraw()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x30f837e901e72af2541dd42b029f438ca0845dbc69f81c7e179665b0686be4e0">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第四次升级逻辑代码"><a class="header-anchor" href="#第四次升级逻辑代码"> </a>第四次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:23:39</td>
<td>给攻击合约第四次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x477c53ac688f27b1d2460d85aa681eda9edefde3">0x477c53ac688f27b1d2460d85aa681eda9edefde3</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x5d8df759d18226781ef1e139e3d1c59862ac9298e4c7a467412325025af6bc25">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:24:54</td>
<td>尝试取款失败</td>
<td>withdraw()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x4402968870e1e08d83eba0f79e7822720a8aa3e6fd36fbc5fe0120c6f3fa701c">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第五次升级逻辑代码"><a class="header-anchor" href="#第五次升级逻辑代码"> </a>第五次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:34:03</td>
<td>给攻击合约第五次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0xe18e97ea16b86f37e335ff1e6d6e96cf74b5f842">0xe18e97ea16b86f37e335ff1e6d6e96cf74b5f842</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xa268fa121d91eeabc59c4935d0f835f22c7123e6b43c06a0789190658821e5dd">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 04:34:51</td>
<td>尝试取款失败</td>
<td>withdraw()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x33ba0953f98cc98dc0ef71113fa8f1512946db7df497877566669d86463b27c5">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第六次升级逻辑代码"><a class="header-anchor" href="#第六次升级逻辑代码"> </a>第六次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 05:14:09</td>
<td>给攻击合约第六次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x114587850bbdd67f69517143106a9c3af7a9d61c">0x114587850bbdd67f69517143106a9c3af7a9d61c</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x760ed9d86ec2846430cb2965c17a37c1908caac6848244f6b0f1233bbc585cf0">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 05:16:24</td>
<td>第一次尝试取款至<code>0x61e365f6031e3cc859911a75c467d3cf2d037e01</code>失败</td>
<td>withdraw1()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xbd0ee9292a47285f723f05d4b40f4f778d5a21e8c5a796719ab90c894173b486">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 09:19:00</td>
<td>第二次尝试取款至<code>0x61e365f6031e3cc859911a75c467d3cf2d037e01</code>失败</td>
<td>withdraw1()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x57ed3b940d236fd52a1031148fe7ad83c7d676de3466ce8847222678b93b219e">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第七次升级逻辑代码"><a class="header-anchor" href="#第七次升级逻辑代码"> </a>第七次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 09:36:12</td>
<td>给攻击合约第七次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x22952a0eb4ebd12a1f2d6c318704420f22a2c3db">0x22952a0eb4ebd12a1f2d6c318704420f22a2c3db</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x065447e1fe4a8d69e660af3570bf59340fdfd51eb1ecbed971472256dcc07cdb">查看</a></td>
</tr>
</tbody>
</table>
<h2 id="第八次升级逻辑代码"><a class="header-anchor" href="#第八次升级逻辑代码"> </a>第八次升级逻辑代码</h2>
<table>
<thead>
<tr>
<th>调用者</th>
<th>触发者</th>
<th>时间</th>
<th>备注</th>
<th>参数</th>
<th>txid</th>
</tr>
</thead>
<tbody>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 09:39:21</td>
<td>给攻击合约第八次升级逻辑合约<a target="_blank" rel="noopener" href="https://bscscan.com/address/0x114587850bbdd67f69517143106a9c3af7a9d61c">0x114587850bbdd67f69517143106a9c3af7a9d61c</a></td>
<td></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x38327b97955cd7f7151b6b4309888a38eb20cd27aada8d23364d6fa3fa350def">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 09:41:09</td>
<td>第一次取款至<code>0x22952a0eb4ebd12a1f2d6c318704420f22a2c3db</code>失败</td>
<td>withdraw1()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x39559c0e38dd4230e330ed585cb5761bf84bedfc76de575db04f40ff7355d564">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 09:54:53</td>
<td>第二次取款至<code>0x22952a0eb4ebd12a1f2d6c318704420f22a2c3db</code>失败</td>
<td>withdraw1()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xf0434705664ae4a55b29a3666ae2673bc9a8852f43070c502ebcca7521d3d043">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 10:56:37</td>
<td>第三次取款至<code>0x91ecadeab1a43ed918309175bcc877ea456378c0</code>失败</td>
<td>withdraw2()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xa4ce16f4ddcbb7eab09d8b9e4d943edcf3f714579174c739aab94a33a54e0fed">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:07:00</td>
<td>第四次尝试，此次操作成功给<code>0x22</code>地址提权，但未能成功取出存款</td>
<td>withdraw1(<code>0x22952a0eb4ebd12a1f2d6c318704420f22a2c3db</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xa50946e61a76a91ba0c4a9147c31a63f3285bebe5e935141833c04df27834085">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:18:21</td>
<td>第五次取款至<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>未能成功</td>
<td>withdraw1()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x3bd6823d3304dd046aadc26c70f5c42f8c0ce84e1991346d1a5a0521848e118a">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:19:45</td>
<td>第六次取款至<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>未能成功</td>
<td>withdraw2()</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x843121bb60581a4f50143a34e752ce8acfbc4304a67f26b3e9bc895ffdea842f">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:27:47</td>
<td>第七次尝试，此次操作成功给<code>0x13b81</code>地址提权，但未能成功取出存款</td>
<td>withdraw1(<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x94c3dac0df93d13205f78509dc79363c3c79e4d50f4a5a2a3614ba11e457fa1d">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:29:17</td>
<td>第八次取款至<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>未能成功</td>
<td>withdraw2(<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x6696cfbe7bf491f24abeae5a9d5fc2e20d65a1bfb2cd072404c554a3e18879a8">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:32:53</td>
<td>第九次取款至<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>成功，大量资产被转移</td>
<td>withdraw2(<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0x6466cad9ad300054f0d560db5619a299f67883ad51b6aeafad3061d09674ac84">查看</a></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x48c94305bddfd80c6f4076963866d968cac27d79">Exploiter</a></td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/address/0x887716168FC8c1A2933F97ea3858a94c9E229201">Attacker</a></td>
<td>2021-10-30 11:36:11</td>
<td>第十次取款至<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>成功，但是已无剩余资产</td>
<td>withdraw2(<code>0x13b81fa9c0873a74c49a85bd8149c1c20bf9d18c</code>)</td>
<td><a target="_blank" rel="noopener" href="https://bscscan.com/tx/0xf27301bf6c824c5dc11eb751e0992a7dfeadf01dcc5350ae86a713d4cf9590f3">查看</a></td>
</tr>
</tbody>
</table>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>wanyvic
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://wanyvic.github.io/posts/4b1fd5af/" title="BXH被盗分析">https://wanyvic.github.io/posts/4b1fd5af/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag"><i class="fa fa-tag"></i> 区块链</a>
              <a href="/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/" rel="tag"><i class="fa fa-tag"></i> 智能合约</a>
              <a href="/tags/BXH/" rel="tag"><i class="fa fa-tag"></i> BXH</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/a537129b/" rel="prev" title="filecoin的元数据证明和lurk">
                  <i class="fa fa-chevron-left"></i> filecoin的元数据证明和lurk
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/b2bb0ade/" rel="next" title="CosmWasm 二 项目创建">
                  CosmWasm 二 项目创建 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline-comments"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2021 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wanyvic</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">113k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:43</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.7/pdfobject.min.js","integrity":"sha256-ph3Dk89VmuTVXG6x/RDzk53SU9LPdAh1tpv0UvnDZ2I="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdn.jsdelivr.net/npm/mermaid@8.13.10/dist/mermaid.min.js","integrity":"sha256-CmZCFVnvol9YL23PfjDflGY5nJwE+Mf/JN+8v+tD/34="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha256-94CNZ/bJtwrBYZrXhCOBvpB4rZUzBnvAsirFv31TMGo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/copy-tex.min.css" integrity="sha256-+oItviPaTmqjDhk4y4fLLUIMgRQYDV/ZyrRNvQiebWM=" crossorigin="anonymous">
  <script class="next-config" data-name="katex" type="application/json">{"copy_tex_js":{"url":"https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/copy-tex.min.js","integrity":"sha256-etSqbSVF4+Lwe8MGk/Vanc1sR+mWv+qOG73fxWw9p94="}}</script>
  <script src="/js/third-party/math/katex.js"></script>


  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.2.0/dist/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://wanyvic.github.io/posts/4b1fd5af/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://waline-kappa-three.vercel.app","placeholder":"发表评论~","avatar":"wavatar","pageSize":10,"visitor":false,"comment_count":true,"requiredFields":["nick"],"meta":["nick","mail","link"],"libUrl":"https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js","emoji":["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji","https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq"],"el":"#waline-comments","path":"/posts/4b1fd5af/"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() => 
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => {
    new Waline(CONFIG.waline);
  });
});
</script><div class="moon-menu">
  <div class="moon-menu-items">
    
    <div id="moon-menu-item-back2bottom" class="moon-menu-item" onclick="back2bottom()">
      <i class='fa fa-chevron-down'></i>    </div>
    
    <div id="moon-menu-item-back2top" class="moon-menu-item" onclick="back2top()">
      <i class='fa fa-chevron-up'></i>    </div>
    
  </div>
  <div class="moon-menu-button">
    <svg class="moon-menu-bg">
      <circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle>
      <circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle>
    </svg>
    <div class="moon-menu-content">
      <div class="moon-menu-icon"><i class='fas fa-ellipsis-v'></i></div>
      <div class="moon-menu-text"></div>
    </div>
  </div>
</div><script src="/js/injector.js"></script>
</body>
</html>
